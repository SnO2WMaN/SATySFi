module Staged1Local = struct

  val ~gen-power n =
    let rec aux n s =
      if n <= 0 then
        &1
      else
        &(~s * ~(aux (n - 1) s))
    in
    &(fun x -> ~(aux n &x))

end
